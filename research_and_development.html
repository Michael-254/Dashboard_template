<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research & Development - Agricultural Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header Component -->
    <div id="header-container"></div>

    <!-- Main Content -->
    <main class="bg-gray-50 px-4 sm:px-6 md:px-8 py-6 sm:py-8">
        <!-- Country Selector Component -->
        <div id="country-selector-container"></div>

        <!-- Page Title Section - Minimal -->
        <div class="mb-6">
            <h1 class="text-2xl font-bold text-gray-800">Research & Development</h1>
        </div>

        <!-- Indicator Cards Container - Grid Layout -->
        <div class="space-y-6">
            <!-- Card 1: Number of varieties released -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden">
                <!-- Card Header with Title -->
                <div class="p-4 sm:p-6 border-b border-gray-100">
                    <div class="mb-4">
                        <h2 class="text-xl sm:text-2xl font-bold text-green-700">Number of varieties released <span class="text-gray-600 text-base font-medium">(Since SSG Intervention)</span></h2>
                    </div>

                    <!-- Crops Legend -->
                    <div class="flex flex-wrap gap-3">
                        <div class="flex items-center space-x-2">
                            <span class="w-3 h-3 rounded-full" style="background-color: #FBBF24;"></span>
                            <span class="text-sm font-medium text-gray-700">Maize</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="w-3 h-3 rounded-full" style="background-color: #FB923C;"></span>
                            <span class="text-sm font-medium text-gray-700">Cowpea</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="w-3 h-3 rounded-full" style="background-color: #10B981;"></span>
                            <span class="text-sm font-medium text-gray-700">Beans</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="w-3 h-3 rounded-full" style="background-color: #9CA3AF;"></span>
                            <span class="text-sm font-medium text-gray-700">Sorghum</span>
                        </div>
                    </div>
                </div>

                <!-- Chart Container -->
                <div class="p-4 sm:p-6">
                    <div class="w-full h-96 relative">
                        <canvas id="varietiesChart"></canvas>
                    </div>
                </div>

                <!-- Card Footer -->
                <div class="px-4 sm:px-6 py-3 border-t border-gray-100 flex items-center justify-between bg-gray-50">
                    <span class="text-xs text-gray-500">Year range: 2018 — 2025</span>
                    <button class="text-green-600 text-sm font-semibold hover:text-green-700 hover:underline transition">
                        View Details →
                    </button>
                </div>
            </div>

            <!-- Card 2: EGS Production -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden">
                <!-- Card Header with Title -->
                <div class="p-4 sm:p-6 border-b border-gray-100">
                    <div class="mb-4">
                        <h2 class="text-xl sm:text-2xl font-bold text-green-700">EGS Production <span class="text-gray-600 text-base font-medium">(Metric Tonnes)</span></h2>
                    </div>

                    <!-- Crops Legend -->
                    <div class="flex flex-wrap gap-3">
                        <div class="flex items-center space-x-2">
                            <span class="w-3 h-3 rounded-full" style="background-color: #FBBF24;"></span>
                            <span class="text-sm font-medium text-gray-700">Maize</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="w-3 h-3 rounded-full" style="background-color: #FB923C;"></span>
                            <span class="text-sm font-medium text-gray-700">Cowpea</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="w-3 h-3 rounded-full" style="background-color: #10B981;"></span>
                            <span class="text-sm font-medium text-gray-700">Beans</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="w-3 h-3 rounded-full" style="background-color: #9CA3AF;"></span>
                            <span class="text-sm font-medium text-gray-700">Sorghum</span>
                        </div>
                    </div>
                </div>

                <!-- Chart Container -->
                <div class="p-4 sm:p-6">
                    <div class="w-full h-96 relative">
                        <canvas id="egsProductionChart"></canvas>
                    </div>
                </div>

                <!-- Card Footer -->
                <div class="px-4 sm:px-6 py-3 border-t border-gray-100 flex items-center justify-between bg-gray-50">
                    <span class="text-xs text-gray-500">Year range: 2018 — 2025</span>
                    <button class="text-green-600 text-sm font-semibold hover:text-green-700 hover:underline transition">
                        View Details →
                    </button>
                </div>
            </div>

            <!-- Card 3: Capacity Building of the NARS Personnel -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden">
                <!-- Card Header with Title -->
                <div class="p-4 sm:p-6 border-b border-gray-100">
                    <div class="mb-4">
                        <h2 class="text-xl sm:text-2xl font-bold text-green-700">Capacity Building of the NARS Personnel <span class="text-gray-600 text-base font-medium">(Number of Personnel Trained)</span></h2>
                    </div>
                </div>

                <!-- Chart Container -->
                <div class="p-4 sm:p-6">
                    <div class="w-full h-96 relative">
                        <canvas id="capacityBuildingChart"></canvas>
                    </div>
                </div>

                <!-- Card Footer -->
                <div class="px-4 sm:px-6 py-3 border-t border-gray-100 flex items-center justify-between bg-gray-50">
                    <span class="text-xs text-gray-500">Year range: 2018 — 2025</span>
                    <button class="text-green-600 text-sm font-semibold hover:text-green-700 hover:underline transition">
                        View Details →
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer Component -->
    <div id="footer-container"></div>

    <!-- JavaScript for Components and Chart -->
    <script>
        // Chart data with multiple crop lines
        const chartData = {
            labels: ['2002', '2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012', '2013', '2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021'],
            datasets: [
                {
                    label: 'Maize',
                    data: [10, 14, 16, 13, 12, 7, 20, 17, 16, 24, 13, 16, 14, 14, 21, 25, 33, 24, 20, 12],
                    borderColor: '#FBBF24',
                    backgroundColor: 'rgba(251, 191, 36, 0.1)',
                    tension: 0.4,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 4,
                    pointBackgroundColor: '#FBBF24'
                },
                {
                    label: 'Cowpea',
                    data: [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1, 1, 1, 1, 0.5, 0.5, 0.5, 0.5, 1, 1, 2, 1, 1, 0.5],
                    borderColor: '#FB923C',
                    backgroundColor: 'rgba(251, 146, 60, 0.1)',
                    tension: 0.4,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 4,
                    pointBackgroundColor: '#FB923C'
                },
                {
                    label: 'Beans',
                    data: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                    borderColor: '#10B981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    tension: 0.4,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 4,
                    pointBackgroundColor: '#10B981'
                },
                {
                    label: 'Sorghum',
                    data: [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 2, 1, 1, 0],
                    borderColor: '#9CA3AF',
                    backgroundColor: 'rgba(156, 163, 175, 0.1)',
                    tension: 0.4,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 4,
                    pointBackgroundColor: '#9CA3AF'
                }
            ]
        };

        // Chart data for EGS Production with multiple crops
        const egsProductionData = {
            labels: ['2018', '2019', '2020', '2021', '2022', '2023', '2024', '2025'],
            datasets: [
                {
                    label: 'Maize',
                    data: [25, 28, 35, 40, 45, 52, 62, 72],
                    borderColor: '#FBBF24',
                    backgroundColor: 'rgba(251, 191, 36, 0.1)',
                    tension: 0.4,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 4,
                    pointBackgroundColor: '#FBBF24'
                },
                {
                    label: 'Cowpea',
                    data: [8, 10, 12, 15, 18, 22, 28, 33],
                    borderColor: '#FB923C',
                    backgroundColor: 'rgba(251, 146, 60, 0.1)',
                    tension: 0.4,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 4,
                    pointBackgroundColor: '#FB923C'
                },
                {
                    label: 'Beans',
                    data: [10, 12, 15, 18, 15, 18, 18, 18],
                    borderColor: '#10B981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    tension: 0.4,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 4,
                    pointBackgroundColor: '#10B981'
                },
                {
                    label: 'Sorghum',
                    data: [2, 2, 6, 2, 4, 3, 2, 2],
                    borderColor: '#9CA3AF',
                    backgroundColor: 'rgba(156, 163, 175, 0.1)',
                    tension: 0.4,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 4,
                    pointBackgroundColor: '#9CA3AF'
                }
            ]
        };

        // Chart data for Capacity Building
        const capacityBuildingData = {
            labels: ['2018', '2019', '2020', '2021', '2022', '2023', '2024', '2025'],
            datasets: [
                {
                    label: 'Personnel Trained',
                    data: [120, 145, 165, 180, 210, 245, 280, 320],
                    borderColor: '#F59E0B',
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    tension: 0.4,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 4,
                    pointBackgroundColor: '#F59E0B'
                }
            ]
        };

        // Function to attach country change listener
        function attachCountryChangeListener() {
            const countrySelect = document.getElementById('countrySelect');
            const selectedCountryDisplay = document.getElementById('selectedCountry');

            if (countrySelect && selectedCountryDisplay) {
                countrySelect.addEventListener('change', function(e) {
                    const selectedCountry = e.target.value;
                    
                    // Update country display
                    selectedCountryDisplay.textContent = selectedCountry;
                    selectedCountryDisplay.style.opacity = '0.5';
                    selectedCountryDisplay.style.transition = 'opacity 0.3s ease-in-out';
                    
                    // Reinitialize chart with new country data (if needed)
                    setTimeout(() => {
                        selectedCountryDisplay.style.opacity = '1';
                        console.log('Country changed to:', selectedCountry);
                    }, 100);
                });
            }
        }

        // Initialize charts
        function initializeCharts() {
            // Chart 1: Varieties
            const varietiesCtx = document.getElementById('varietiesChart');
            if (varietiesCtx) {
                new Chart(varietiesCtx, {
                    type: 'line',
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12,
                                titleFont: { size: 14, weight: 'bold' },
                                bodyFont: { size: 13 },
                                borderColor: '#e5e7eb',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 40,
                                ticks: { font: { size: 12 }, color: '#6b7280' },
                                grid: { color: '#f3f4f6', drawBorder: false }
                            },
                            x: {
                                ticks: { font: { size: 12 }, color: '#6b7280' },
                                grid: { display: false, drawBorder: false }
                            }
                        }
                    }
                });
            }

            // Chart 2: EGS Production
            const egsCtx = document.getElementById('egsProductionChart');
            if (egsCtx) {
                new Chart(egsCtx, {
                    type: 'line',
                    data: egsProductionData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12,
                                titleFont: { size: 14, weight: 'bold' },
                                bodyFont: { size: 13 },
                                borderColor: '#e5e7eb',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: { font: { size: 12 }, color: '#6b7280' },
                                grid: { color: '#f3f4f6', drawBorder: false }
                            },
                            x: {
                                ticks: { font: { size: 12 }, color: '#6b7280' },
                                grid: { display: false, drawBorder: false }
                            }
                        }
                    }
                });
            }

            // Chart 3: Capacity Building
            const capacityCtx = document.getElementById('capacityBuildingChart');
            if (capacityCtx) {
                new Chart(capacityCtx, {
                    type: 'line',
                    data: capacityBuildingData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12,
                                titleFont: { size: 14, weight: 'bold' },
                                bodyFont: { size: 13 },
                                borderColor: '#e5e7eb',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 350,
                                ticks: { font: { size: 12 }, color: '#6b7280' },
                                grid: { color: '#f3f4f6', drawBorder: false }
                            },
                            x: {
                                ticks: { font: { size: 12 }, color: '#6b7280' },
                                grid: { display: false, drawBorder: false }
                            }
                        }
                    }
                });
            }
        }

        // Load Header Component
        fetch('./components/header.html')
            .then(response => {
                if (!response.ok) throw new Error('Failed to load header');
                return response.text();
            })
            .then(html => {
                document.getElementById('header-container').innerHTML = html;
                console.log('Header loaded successfully');
                // Call the header's setActiveNavLink function after loading
                setTimeout(() => {
                    if (typeof setActiveNavLink === 'function') {
                        setActiveNavLink();
                    }
                }, 50);
            })
            .catch(error => console.error('Error loading header:', error));

        // Load Country Selector Component
        fetch('./components/country-selector.html')
            .then(response => {
                if (!response.ok) throw new Error('Failed to load country selector');
                return response.text();
            })
            .then(html => {
                document.getElementById('country-selector-container').innerHTML = html;
                console.log('Country selector loaded successfully');
                // Attach listener after component is loaded
                setTimeout(() => {
                    attachCountryChangeListener();
                }, 100);
            })
            .catch(error => console.error('Error loading country selector:', error));

        // Load Footer Component
        fetch('./components/footer.html')
            .then(response => {
                if (!response.ok) throw new Error('Failed to load footer');
                return response.text();
            })
            .then(html => {
                document.getElementById('footer-container').innerHTML = html;
                console.log('Footer loaded successfully');
            })
            .catch(error => console.error('Error loading footer:', error));

        // Initialize charts when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            initializeCharts();
            console.log('All charts initialized');
        });
    </script>
</body>
</html>
